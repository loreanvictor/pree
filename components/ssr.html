<!DOCTYPE html><html lang="en"><head><base href="/pree/">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    

    
    <link rel="icon" type="image/png" sizes="32x32" href="favicon.ico">

    <link rel="stylesheet" href="https://unpkg.com/nokss">
    <link rel="preload" as="style" onload="this.onload=null;this.rel='stylesheet'" href="https://esm.sh/graphis/font/graphis.css">
    <link rel="stylesheet" href="./theme.css">
    
    <script src="https://unpkg.com/@highlightjs/cdn-assets@11.9.0/highlight.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github-dark.min.css">

    
    
    
    
    

    <script src="./.components/emo-li.js" type="module"></script>
    <script type="module" src="./.components/prev-next.js"></script>
  <title>pree: server side rendering</title>
          
        <link rel="prefetch" href="components/index.html"><link rel="prefetch" href="components/build-env.html"></head>
  <body><aside aria-hidden="true">
      <use-html src="./_toc.html"><base href="/pree/"><style>
  #toc {
    a:not(:hover) {
      text-decoration-color: transparent;
    }

    hr {
      margin: 0;
    }
  }

</style>

<m-d id="toc" onparse="document.querySelector('prev-next').controls?.load()"><p><a href="index.html">Home</a> <br><a href="motivation.html">Motivation</a> <br><a href="install.html">Installation</a></p>
<hr>
<p><a href="usage/index.html"><strong>Usage</strong></a> <br>  <a href="usage/meta-layout.html">Metadata &amp; Layouts</a> <br>  <a href="usage/build-only-scripts.html">Build-Only Scripts</a> <br>  <a href="usage/config.html">Configuration</a></p>
<hr>
<p><a href="components/index.html"><strong>Using Components</strong></a> <br>  <a href="components/ssr.html">Server Side Rendering</a> <br>  <a href="components/build-env.html">Build Environment</a> <br>  <a href="components/publish.html">Publishing Components</a></p>
<hr>
<p><a href="deploy.html">Deploy</a> <br><a href="api.html">JavaScript API</a> <br><a href="credits.html">Credits</a></p>
<p><br><br></p>
<template shadowrootmode="open"><slot></slot></template></m-d>
<template shadowrootmode="open"><slot></slot></template></use-html>
    </aside>
    <main>
      <m-d><h2 id="server-side-rendering">Server Side Rendering<menu role="toolbar"><button ref="?" aria-label="copy link" class="icon">🔗</button></menu></h2>
<blockquote>
<p>Server side rendering refers to running component code on the server (or during build time) first, instead of running them on the client. This is useful as clients don't have to wait for component code to load and run before seeing their content.</p>
</blockquote>
<p><code>pree</code> pre-renders ALL web components, whether they support SSR or not. Components without interactivity (static components), can be <a href="usage/build-only-scripts">loaded build-only</a>, so that clients don't have to load or execute their code at all. For interactive components, there are two alternatives:</p>
<template shadowrootmode="open"><slot></slot></template></m-d>

<emo-li>
  <span slot="emo">🦕</span> They can re-render on the client, replacing pre-rendered content, or,
<template shadowrootmode="open">
  <style>
  .holder {
    display: flex;
    gap: 1rem;
    align-items: baseline;

    & > span {
      width: 1.2rem;
      text-align: center;
      display: inline-block;
    }
  }

  </style>
  <div class="holder">
    <span><slot name="emo"></slot></span>
    <div><slot></slot></div>
  </div>
</template></emo-li>
<emo-li>
  <span slot="emo">🧠</span> They can use the pre-rendered content and add interactivity to it.
<template shadowrootmode="open">
  <style>
  .holder {
    display: flex;
    gap: 1rem;
    align-items: baseline;

    & > span {
      width: 1.2rem;
      text-align: center;
      display: inline-block;
    }
  }

  </style>
  <div class="holder">
    <span><slot name="emo"></slot></span>
    <div><slot></slot></div>
  </div>
</template></emo-li>

<m-d><p>Naturally, components supporting SSR and hydrating pre-rendered content instead of recreating it, will provide a better performance and user experience as they become interactive faster.</p>
<hr>
<p>To write components supporting SSR, you can use libraries such as <a href="https://github.com/loreanvictor/minicomp">minicomp</a>, combined with <a href="https://github.com/loreanvictor/rehtm">rehtm</a>:</p>
<pre><code class="language-js hljs language-javascript" data-highlighted="yes"><span class="hljs-keyword">import</span> { define } <span class="hljs-keyword">from</span> <span class="hljs-string">'https://esm.sh/minicomp'</span>
<span class="hljs-keyword">import</span> { ref, template } <span class="hljs-keyword">from</span> <span class="hljs-string">'https://esm.sh/rehtm'</span>

<span class="hljs-title function_">define</span>(<span class="hljs-string">'a-button'</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">const</span> span = <span class="hljs-title function_">ref</span>()
  <span class="hljs-keyword">let</span> count = <span class="hljs-number">0</span>
  
  <span class="hljs-keyword">return</span> template<span class="hljs-string">`
    &lt;button onclick=<span class="hljs-subst">${() =&gt; span.current.textContent = ++count}</span>&gt;
      Clicked &lt;span ref=<span class="hljs-subst">${span}</span> role="status"&gt;0&lt;/span&gt; times
    &lt;/button&gt;
  `</span>
})
</code><menu role="toolbar" align="right"><button ref="?" class="icon" aria-label="copy">📑</button></menu></pre>
<br>

<p>You can also support SSR without any library, simply check for existence of <code>this.shadowRoot</code> and render accordingly:</p>
<pre><code class="language-js hljs language-javascript" data-highlighted="yes"><span class="hljs-keyword">class</span> <span class="hljs-title class_">AButton</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">HTMLElement</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) {
    <span class="hljs-variable language_">super</span>()

    <span class="hljs-keyword">let</span> span, button
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">shadowRoot</span>) {
      span = <span class="hljs-variable language_">this</span>.<span class="hljs-property">shadowRoot</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'span'</span>)
      button = <span class="hljs-variable language_">this</span>.<span class="hljs-property">shadowRoot</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'button'</span>)
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">const</span> shadow = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">attachShadow</span>({ <span class="hljs-attr">mode</span>: <span class="hljs-string">'open'</span> })
      
      span = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'span'</span>)
      span.<span class="hljs-property">textContent</span> = <span class="hljs-number">0</span>

      button = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'button'</span>)
      button.<span class="hljs-title function_">append</span>(<span class="hljs-string">'Clicked '</span>, span, <span class="hljs-string">' times'</span>)

      shadow.<span class="hljs-title function_">append</span>(button)
    }

    button.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, <span class="hljs-function">() =&gt;</span> {
      span.<span class="hljs-property">textContent</span> = ++count
    })
  }
}

customElements.<span class="hljs-title function_">define</span>(<span class="hljs-string">'a-button'</span>, <span class="hljs-title class_">AButton</span>)
</code><menu role="toolbar" align="right"><button ref="?" class="icon" aria-label="copy">📑</button></menu></pre>
<br><template shadowrootmode="open"><slot></slot></template></m-d>

<blockquote>

<emo-li>
  <span slot="emo">📖</span>
  <m-d><p><a href="https://developer.chrome.com/docs/css-ui/declarative-shadow-dom#component_hydration">Read this</a> for more info on hydration with declarative shadow DOM.</p>
<template shadowrootmode="open"><slot></slot></template></m-d>
<template shadowrootmode="open">
  <style>
  .holder {
    display: flex;
    gap: 1rem;
    align-items: baseline;

    & > span {
      width: 1.2rem;
      text-align: center;
      display: inline-block;
    }
  }

  </style>
  <div class="holder">
    <span><slot name="emo"></slot></span>
    <div><slot></slot></div>
  </div>
</template></emo-li>

</blockquote>

<br>
<change-history><template shadowrootmode="open"><style>a {
        display: block;
        text-align: right;
        opacity:.35;
        font-size: 0.8rem;
        font-style: italic;
        text-decoration: none;
        color: inherit;
      }</style><a ref="?" target="_blank" href="https://github.com/loreanvictor/pree/commit/5474512088dada9ca9b425834d49edd9bd241abb">Updated at <span ref="?">Feb 10, 2024</span> <br>for <span ref="?">pree</span> version <span ref="?">0.1.17</span></a></template></change-history>
<br>
      <prev-next><template shadowrootmode="open"><link rel="stylesheet" href="https://unpkg.com/nokss"><link rel="stylesheet" href="https://unpkg.com/graphis/font/graphis.css"><style>i {
      font-family: 'graphis', sans-serif;
      font-style: normal;
      font-size: 2rem;
      opacity: .25;
    }

    section[role="feed"] {
      flex-direction: row;
      &[aria-hidden] {
        opacity: 0;
      }

      opacity: 1;
      transition: opacity .5s;

      article {
        flex-grow: 1;
        display: flex;
        flex-direction: row;
        align-items: center;
        gap: 1rem;

        & > a {
          display: block;
          flex-grow: 1;
          text-decoration: none!important;
        }

        &.next {
          flex-basis: flex-end;
          text-align: right;
        }

        @media (max-width: 480px) {
          &:first-child:not(:last-child) {
            display: none;
          }
        }
      }

      margin-bottom: 4rem;
    }</style><section role="feed" ref="?">        
        
          <article>
            <i>⬅</i>
            <a href="components/index.html">
              <small>Previosly</small><br>
              Using Components
            </a>
          </article>
          
        
          <article class="next">
            <a href="components/build-env.html">
              <small>Up Next</small><br>
              Build Environment
            </a>
            <i>➡</i>
          </article>
          
      </section></template></prev-next>
    </main>
    <footer>
      <use-html src="./_footer.html"><base href="/pree/"><script type="module" src="./.components/menu-toggle.js"></script>



<div style="display: flex" class="local-style-sjh111hsin" data-local-style="local-style-sjh111hsin"><style>.local-style-sjh111hsin[data-local-style=local-style-sjh111hsin] { 
 
    b {
      opacity: .35;
      font-weight: normal;
      display: inline-block;
      transform: scaleY(2);
      margin: 0 .35rem;
    }
   
 }</style>
  

  <menu-toggle><template shadowrootmode="open"><link rel="stylesheet" href="https://unpkg.com/nokss"><link rel="stylesheet" href="https://unpkg.com/graphis/font/graphis.css"><style>.icon {
      font-family: 'graphis', sans-serif;
      font-style: normal;
      font-size: 1.2rem;
    }

    button[role="switch"][aria-checked="true"]>span{
      color: var(--background-color);
    }</style><button ref="?" role="switch" aria-label="toggle sidebar" aria-checked="true"><span class="icon">❌</span><span class="icon">⩧</span></button></template></menu-toggle>
  <div style="flex-grow: 1"></div>
  <div align="right">
    <small-device>
      <gh-link no-label="">pree<template shadowrootmode="open"><link rel="stylesheet" href="https://unpkg.com/nokss/dist/bundles/md.css"><style>octo-icon { opacity: .45; transition: opacity .15s; }
      a:not([role]) {
        filter: none;
        color: var(--text-color);
        &:hover octo-icon { opacity: 1; }
      }</style><a ref="?" target="_blank" href="https://github.com/loreanvictor/pree"><octo-icon style=""><template shadowrootmode="open">
  <style>
    svg {
      width: 1.2rem;
      vertical-align: -.65rem;
      margin-right: .15rem;
    }
  </style>
  <svg width="32" height="32" viewBox="0 0 98 96" xmlns="http://www.w3.org/2000/svg"> <path fill-rule="evenodd" clip-rule="evenodd" d="M48.854 0C21.839 0 0 22 0 49.217c0 21.756 13.993 40.172 33.405 46.69 2.427.49 3.316-1.059 3.316-2.362 0-1.141-.08-5.052-.08-9.127-13.59 2.934-16.42-5.867-16.42-5.867-2.184-5.704-5.42-7.17-5.42-7.17-4.448-3.015.324-3.015.324-3.015 4.934.326 7.523 5.052 7.523 5.052 4.367 7.496 11.404 5.378 14.235 4.074.404-3.178 1.699-5.378 3.074-6.6-10.839-1.141-22.243-5.378-22.243-24.283 0-5.378 1.94-9.778 5.014-13.2-.485-1.222-2.184-6.275.486-13.038 0 0 4.125-1.304 13.426 5.052a46.97 46.97 0 0 1 12.214-1.63c4.125 0 8.33.571 12.213 1.63 9.302-6.356 13.427-5.052 13.427-5.052 2.67 6.763.97 11.816.485 13.038 3.155 3.422 5.015 7.822 5.015 13.2 0 18.905-11.404 23.06-22.324 24.283 1.78 1.548 3.316 4.481 3.316 9.126 0 6.6-.08 11.897-.08 13.526 0 1.304.89 2.853 3.316 2.364 19.412-6.52 33.405-24.935 33.405-46.691C97.707 22 75.788 0 48.854 0z" fill="currentColor"></path> </svg>
</template></octo-icon><slot ref="?" style="display: none">GitHub</slot></a></template></gh-link>  
      <npm-badge no-label="">pree<template shadowrootmode="open"><link rel="stylesheet" href="https://unpkg.com/nokss/dist/bundles/md.css"><style>a:not([role]) {
        filter: none;
        color: var(--text-color);
      }
      img {
        vertical-align: middle;
        margin-left: 0.5rem;
      }</style><a ref="?" target="_blank" href="https://www.npmjs.com/package/pree"><slot ref="?" style="display: none">NPM</slot><img alt="npm" ref="?" src="https://img.shields.io/npm/v/pree.svg?label=&amp;style=normal"></a></template></npm-badge>
    <template shadowrootmode="open">
  <style>
    @media (min-width: 768px) {
      :host {
        display: none;
      }
    }
  </style>
  <slot></slot>
</template></small-device>
    <large-device>
      <gh-link>github<template shadowrootmode="open"><link rel="stylesheet" href="https://unpkg.com/nokss/dist/bundles/md.css"><style>octo-icon { opacity: .45; transition: opacity .15s; }
      a:not([role]) {
        filter: none;
        color: var(--text-color);
        &:hover octo-icon { opacity: 1; }
      }</style><a ref="?" target="_blank" href="https://github.com/loreanvictor/pree"><octo-icon style=""><template shadowrootmode="open">
  <style>
    svg {
      width: 1.2rem;
      vertical-align: -.65rem;
      margin-right: .15rem;
    }
  </style>
  <svg width="32" height="32" viewBox="0 0 98 96" xmlns="http://www.w3.org/2000/svg"> <path fill-rule="evenodd" clip-rule="evenodd" d="M48.854 0C21.839 0 0 22 0 49.217c0 21.756 13.993 40.172 33.405 46.69 2.427.49 3.316-1.059 3.316-2.362 0-1.141-.08-5.052-.08-9.127-13.59 2.934-16.42-5.867-16.42-5.867-2.184-5.704-5.42-7.17-5.42-7.17-4.448-3.015.324-3.015.324-3.015 4.934.326 7.523 5.052 7.523 5.052 4.367 7.496 11.404 5.378 14.235 4.074.404-3.178 1.699-5.378 3.074-6.6-10.839-1.141-22.243-5.378-22.243-24.283 0-5.378 1.94-9.778 5.014-13.2-.485-1.222-2.184-6.275.486-13.038 0 0 4.125-1.304 13.426 5.052a46.97 46.97 0 0 1 12.214-1.63c4.125 0 8.33.571 12.213 1.63 9.302-6.356 13.427-5.052 13.427-5.052 2.67 6.763.97 11.816.485 13.038 3.155 3.422 5.015 7.822 5.015 13.2 0 18.905-11.404 23.06-22.324 24.283 1.78 1.548 3.316 4.481 3.316 9.126 0 6.6-.08 11.897-.08 13.526 0 1.304.89 2.853 3.316 2.364 19.412-6.52 33.405-24.935 33.405-46.691C97.707 22 75.788 0 48.854 0z" fill="currentColor"></path> </svg>
</template></octo-icon><slot ref="?" style="">GitHub</slot></a></template></gh-link>
      <b>|</b>
      <npm-badge design="flat-square">npm<template shadowrootmode="open"><link rel="stylesheet" href="https://unpkg.com/nokss/dist/bundles/md.css"><style>a:not([role]) {
        filter: none;
        color: var(--text-color);
      }
      img {
        vertical-align: middle;
        margin-left: 0.5rem;
      }</style><a ref="?" target="_blank" href="https://www.npmjs.com/package/pree"><slot ref="?" style="">NPM</slot><img alt="npm" ref="?" src="https://img.shields.io/npm/v/pree.svg?label=&amp;style=flat-square"></a></template></npm-badge>
    <template shadowrootmode="open">
  <style>
    @media (max-width: 767px) {
      :host {
        display: none;
      }
    }
  </style>
  <slot></slot>
</template></large-device>
  </div>
</div><template shadowrootmode="open"><slot></slot></template></use-html>
    </footer>
    
    <script type="module" src="copy.js"></script>
  

</body></html>